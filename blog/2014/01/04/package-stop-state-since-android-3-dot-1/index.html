
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Package Stopped State Since Android 3.1 - 技术小黑屋</title>
  <meta name="author" content="androidyue">
  <meta name="ujianVerification" content="13e7551f5af04296bb891d33b010bf6b" />
  
  <meta name="description" content="First Bite Since Android 3.1, Android has introduced a LaunchControl mechanism. It&rsquo;s call Stopped State.
Here is what Google describes What is &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://androidyue.github.io/blog/2014/01/04/package-stop-state-since-android-3-dot-1">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="技术小黑屋" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-43841039-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">技术小黑屋</a></h1>
  
    <h2>Better Than Before</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:androidyue.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Package Stopped State Since Android 3.1</h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-01-04T20:07:00+08:00" pubdate data-updated="true">Jan 4<span>th</span>, 2014</time>
        
         | <a href="#disqus_thread">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><h2>First Bite</h2>

<p>Since Android 3.1, Android has introduced a LaunchControl mechanism. It&rsquo;s call Stopped State.
Here is what Google describes</p>

<h4>What is Stopped State</h4>

<blockquote><p>Starting from Android 3.1, the system&rsquo;s package manager keeps track of applications that are in a stopped state and provides a means of controlling their launch from background processes and other applications.</p>

<p>Note that an application&rsquo;s stopped state is not the same as an Activity&rsquo;s stopped state. The system manages those two stopped states separately.</p></blockquote>

<h4>Why Android Adds this</h4>

<blockquote><p>Note that the system adds FLAG_EXCLUDE_STOPPED_PACKAGES to all broadcast intents. It does this to prevent broadcasts from background services from inadvertently or unnecessarily launching components of stoppped applications. A background service or application can override this behavior by adding the FLAG_INCLUDE_STOPPED_PACKAGES flag to broadcast intents that should be allowed to activate stopped applications.</p></blockquote>

<p>As the above references point out it will prevent broadcast intents delivering to stopped packages. Actually this control mechanism will ensure safety and save energy.</p>

<h2>State Switch from/to Stopped State</h2>

<p>What Google says</p>

<blockquote><p>Applications are in a stopped state when they are first installed but are not yet launched and when they are manually stopped by the user (in Manage Applications).</p></blockquote>

<h3>To Stopped Sate</h3>

<ul>
<li>Manually force-stop in Manage Application of Settings.</li>
<li>adb shell am force-stop package-name</li>
<li>Use Hidden Method ActivityManager.forceStopPackages(String packageName) with Right Permission &lt;uses-permission android:name=&ldquo;android.permission.FORCE_STOP_PACKAGES&rdquo;/> It&rsquo;s without test.</li>
</ul>


<h3>To Normal State (Not Stopped)</h3>

<ul>
<li>Manually Launch your application.</li>
<li>Use adb to Activate components(Activity or Receiver ) of the application</li>
</ul>


<h2>Send Broadcast Intent to Stopped Packages</h2>

<blockquote><p>The platform defines two new intent flags that let a sender specify whether the Intent should be allowed to activate components in stopped application.</p>

<p>FLAG_INCLUDE_STOPPED_PACKAGES — Include intent filters of stopped applications in the list of potential targets to resolve against.
FLAG_EXCLUDE_STOPPED_PACKAGES — Exclude intent filters of stopped applications from the list of potential targets.
When neither or both of these flags is defined in an intent, the default behavior is to include filters of stopped applications in the list of potential targets.</p></blockquote>

<ul>
<li>Add your Intent Flag FLAG_INCLUDE_STOPPED_PACKAGES in Java</li>
<li>Use ADB with Flag FLAG_INCLUDE_STOPPED_PACKAGES such as <strong>adb shell am broadcast -a com.android.vending.INSTALL_REFERRER -f 32</strong></li>
</ul>


<h2>Check Package Stopped</h2>

<ul>
<li>Manually Check InstalledAppDetails in Manage applications of Settings.</li>
<li>Step into Terminal of the Device and <strong>cat /data/system/packages-stopped.xml</strong></li>
</ul>


<h2>special Issues</h2>

<ul>
<li>Q:If My application has no activities and it just has a receiver, How can I activate and receive common broadcast intents?</li>
<li><p>A:Actually your above application is actually Not Stopped State when it&rsquo;s first installed. Becuase It has no launcher clickable chance. It can receive normal broadcast smoothly If you do not manually force-stop it.</p></li>
<li><p>Q:Will the system application be in stopped state when it&rsquo;s first installed?</p></li>
<li><p>A:The apps located in /system/app are what we called System Applications. It&rsquo;s Not in stopped state when it&rsquo;s installed.</p></li>
<li><p>Q:Will Google Play App still sends campaign broadcast to my application to keep track of install referrers?</p></li>
<li>A:Actually It does work smoothly. And I have tested on 4.0 OS device. I think the Play Store App adds FLAG_INCLUDE_STOPPED_PACKAGES to the broadcast intent.</li>
</ul>


<h2>Referrences Links</h2>

<ul>
<li><a href="http://developer.android.com/about/versions/android-3.1.html">http://developer.android.com/about/versions/android-3.1.html</a></li>
</ul>

</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">androidyue</span></span>

      








  


<time datetime="2014-01-04T20:07:00+08:00" pubdate data-updated="true">Jan 4<span>th</span>, 2014</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/3-dot-1/'>3.1</a>, <a class='category' href='/blog/categories/android/'>Android</a>, <a class='category' href='/blog/categories/googleplay/'>GooglePlay</a>, <a class='category' href='/blog/categories/launchcontrol/'>LaunchControl</a>, <a class='category' href='/blog/categories/package/'>Package</a>, <a class='category' href='/blog/categories/stop/'>Stop</a>, <a class='category' href='/blog/categories/receiver/'>receiver</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://androidyue.github.io/blog/2014/01/04/package-stop-state-since-android-3-dot-1/" data-via="" data-counturl="http://androidyue.github.io/blog/2014/01/04/package-stop-state-since-android-3-dot-1/" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2014/01/04/ri-yu-wen-fa-kudasai/" title="Previous Post: 日语文法:ください">&laquo; 日语文法:ください</a>
      
      
        <a class="basic-alignment right" href="/blog/2014/01/12/set-the-preferred-application-in-android/" title="Next Post: Set The Preferred Application in Android">Set The Preferred Application in Android &raquo;</a>
      
    </p>
  </footer>
  </article>

  <section>
  <h1>Comments</h1>
   <!-- UJian Button BEGIN -->
<div class="ujian-hook"></div>
<script type="text/javascript">var ujian_config = {num:12,picSize:84,textHeight:45};</script>
<script type="text/javascript" src="http://v1.ujian.cc/code/ujian.js?uid=1728662"></script>
<a href="http://www.ujian.cc" style="border:0;"><img src="http://img.ujian.cc/pixel.png" alt="友荐云推荐" style="border:0;padding:0;margin:0;" /></a>
<!-- UJian Button END -->
<!-- UY BEGIN -->
<div id="uyan_frame"></div>
<script type="text/javascript" src="http://v2.uyan.cc/code/uyan.js?uid=1728662"></script>
<!-- UY END -->

  </section>

</div>

<aside class="sidebar">
  
    <a href="http://stackoverflow.com/users/749727/androidyue">
<img src="http://stackoverflow.com/users/flair/749727.png" width="270" height="58" alt="profile for androidyue at Stack Overflow, Q&amp;A for professional and enthusiast programmers" title="profile for androidyue at Stack Overflow, Q&amp;A for professional and enthusiast programmers">
</a>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2014/06/14/check-camera-in-android/">检查Android是否具有摄像头</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/06/05/qu-chu-mysqllian-jie-shi-de-bao-jing-yin/">去除mysql连接时的报警音</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/05/27/load-url-with-extra-http-headers-using-webview-in-android/">Load URL With Extra HTTP Headers Using WebView in Android</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/05/21/check-if-a-thread-is-main-thread-in-android/">Check if a Thread Is Main Thread in Android</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/05/15/quickly-find-content-in-files/">Quickly Find Content in Files</a>
      </li>
    
  </ul>
</section>


<section class="googleplus">
  <h1>
    <a href="https://plus.google.com/105362551238192049560?rel=author">
      <img src="http://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
      Google+
    </a>
  </h1>
</section>


<script type="text/javascript">var switchTo5x=true;</script>
<script type="text/javascript" src="http://w.sharethis.com/button/buttons.js"></script>
<script type="text/javascript" src="http://s.sharethis.com/loader.js"></script>

<script type="text/javascript">stLight.options({publisher: "c4f362f5-c619-4481-a7ab-bc73e42dc601", doNotHash: false, doNotCopy: false, hashAddressBar: true});</script>
<script>
    var options={ "publisher": "c4f362f5-c619-4481-a7ab-bc73e42dc601", "position": "right", "ad": { "visible": false, "openDelay": 5, "closeDelay": 0 }, "chicklets": { "items": ["googleplus", "sina", "facebook", "twitter", "linkedin", "pinterest", "tumblr", "email", "sharethis"] } };
    var st_hover_widget = new sharethis.widgets.hoverbuttons(options);
</script>
<section>
<h1>Blogrolls</h1>
<ul>
    <li><a href="http://www.pcyoyo.com/" target="__blank">Pcyoyo</a></li>
</ul>
</section>

  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - androidyue -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'androidyue';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://androidyue.github.io/blog/2014/01/04/package-stop-state-since-android-3-dot-1/';
        var disqus_url = 'http://androidyue.github.io/blog/2014/01/04/package-stop-state-since-android-3-dot-1/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
