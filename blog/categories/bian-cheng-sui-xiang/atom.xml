<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: 编程随想 | 技术小黑屋]]></title>
  <link href="http://droidyue.com/blog/categories/bian-cheng-sui-xiang/atom.xml" rel="self"/>
  <link href="http://droidyue.com/"/>
  <updated>2014-07-27T20:00:48+08:00</updated>
  <id>http://droidyue.com/</id>
  <author>
    <name><![CDATA[androidyue]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[纠结才能写出好代码]]></title>
    <link href="http://droidyue.com/blog/2014/07/27/think-twice-when-coding/"/>
    <updated>2014-07-27T14:41:00+08:00</updated>
    <id>http://droidyue.com/blog/2014/07/27/think-twice-when-coding</id>
    <content type="html"><![CDATA[<p>程序员的代码修炼应该有两个目标，一个是代码的执行效率，另一个是代码的可读性。朝着这两个目标努力的人很多，但是能够达到目标的人很少。</p>

<p>以前部门老大曾经说过一句话，大概意思是，想要写出好的代码，就要在写的时候纠结一会儿。</p>

<p>其实编程本身就是一个寻找最优解的哲学问题。解决一个问题，有时候我们要适度纠结，来使我们的代码更加可读，效率更高。</p>

<!--more-->


<p>以下以一个简单的例子，列举一下一个小纠结的问题。我们这里尽量将重点放在如何改善代码等问题上。</p>

<h2>方法作用</h2>

<p>从WebView中读取Favicon，并且返回，如果webview为null，或者web.getFavicon()为null，则返回默认的一个图标。</p>

<h2>原始的代码</h2>

<p>```java
public Bitmap getFavicon(final WebView webview) {</p>

<pre><code>if (null != webview &amp;&amp; null != webview.getFavicon()) {
    return webview.getFavicon();
} else {
    return BitmapFactory.decodeResource(getResources(), R.drawable.default_favicon);
}
</code></pre>

<p>}
```
上面存在一种情况，即null != webview &amp;&amp; null != webview.getFavicon() 这个条件成立的时候，其实还是有改善的地方，因为这种情况下webview.getFavicon()会存在两次调用，一次作为判断条件需要，另一次是返回引用需要。</p>

<h2>这样改好么</h2>

<p>```java
public Bitmap getFavicon(final WebView webview) {</p>

<pre><code>if (null != webview) {
    Bitmap favicon = webview.getFavicon();
    if (null != favicon) {
        return favicon;
    } else {
        return BitmapFactory.decodeResource(getResources(), R.drawable.default_favicon);
    }
} else {
    return BitmapFactory.decodeResource(getResources(), R.drawable.default_favicon);
}
</code></pre>

<p>}
```
这种情况下，没有了上面存在的两次调用的问题了，但是关于返回默认值是存在两处相同的代码，如果需要修改默认的图标时，有可能需要修改两次。还是不够好。</p>

<h2>这个总可以了吧</h2>

<p>```java
public Bitmap getFavicon(final WebView webview) {</p>

<pre><code>Bitmap defaultFavicon = BitmapFactory.decodeResource(getResources(), R.drawable.default_favicon);
if (null != webview) {
    Bitmap favicon = webview.getFavicon();
    if (null != favicon) {
        return favicon;
    } else {
        return defaultFavicon;
    }
} else {
    return defaultFavicon;
}
</code></pre>

<p>}
```
这个确实没有上面的两个问题了，但是还是有不完美的地方，就是如果webview不为null，并且webview.getFavicon()也不为null，那么<strong>Bitmap defaultFavicon = BitmapFactory.decodeResource(getResources(), R.drawable.default_favicon);</strong>实际上是多余的。</p>

<h2>终于改好了</h2>

<p>```java
public Bitmap getFavicon(final WebView webview) {</p>

<pre><code>Bitmap favicon = null;
if (null != webview &amp;&amp; (favicon = webview.getFavicon()) != null) {
    return favicon;
} else {
    return BitmapFactory.decodeResource(getResources(), R.drawable.default_favicon);
}
</code></pre>

<p>}
```
对，上面的代码没有一处多余，并且也是最简单的。</p>

<p>从现在开始，写代码的时候纠结吧。不要仅仅为了实现，更不要追求代码的数量，培养你的代码洁癖，做个代码艺术家。</p>

<h3>其他</h3>

<ul>
<li><a href="http://www.amazon.cn/gp/product/B0061XKRXA/ref=as_li_tf_tl?ie=UTF8&camp=536&creative=3200&creativeASIN=B0061XKRXA&linkCode=as2&tag=droidyue-23">纠结经典：代码大全</a><img src="http://ir-cn.amazon-adsystem.com/e/ir?t=droidyue-23&l=as2&o=28&a=B0061XKRXA" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" /></li>
<li><a href="http://www.amazon.cn/gp/product/B0031M9GHC/ref=as_li_tf_tl?ie=UTF8&camp=536&creative=3200&creativeASIN=B0031M9GHC&linkCode=as2&tag=droidyue-23">如何写出高效整洁的代码</a><img src="http://ir-cn.amazon-adsystem.com/e/ir?t=droidyue-23&l=as2&o=28&a=B0031M9GHC" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" /></li>
<li><a href="http://www.amazon.cn/gp/product/B003BY6PLK/ref=as_li_tf_tl?ie=UTF8&camp=536&creative=3200&creativeASIN=B003BY6PLK&linkCode=as2&tag=droidyue-23">Martin Fowler这样重构代码</a><img src="http://ir-cn.amazon-adsystem.com/e/ir?t=droidyue-23&l=as2&o=28&a=B003BY6PLK" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" /></li>
</ul>

]]></content>
  </entry>
  
</feed>
