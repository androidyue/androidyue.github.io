<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Ruby | 技术小黑屋]]></title>
  <link href="http://droidyue.com/blog/categories/ruby/atom.xml" rel="self"/>
  <link href="http://droidyue.com/"/>
  <updated>2014-08-22T23:40:51+08:00</updated>
  <id>http://droidyue.com/</id>
  <author>
    <name><![CDATA[androidyue]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Ruby常用文件操作]]></title>
    <link href="http://droidyue.com/blog/2014/08/21/file-code-sinppets-in-ruby/"/>
    <updated>2014-08-21T19:20:00+08:00</updated>
    <id>http://droidyue.com/blog/2014/08/21/file-code-sinppets-in-ruby</id>
    <content type="html"><![CDATA[<p>初学Ruby，很多需要学习，现在开始尝试使用Ruby来写一个脚本，其中用到了很多文件相关的操作，这里阶段地整理一些。便于后续的再次查找。</p>

<!--more-->


<h3>是否为文件</h3>

<p><code>ruby
File.file?("file_path")
</code></p>

<h3>是否为目录</h3>

<p><code>ruby
File.directory?("file_path")
</code></p>

<h3>从路径中获取文件名</h3>

<p>```ruby
File.basename(&lsquo;/tmp/adb.log&rsquo;)  #=> &ldquo;adb.log&rdquo;</p>

<h1>从上面结果中移除扩展名</h1>

<p>File.basename(&lsquo;/tmp/adb.log&rsquo;, &lsquo;.log&rsquo;) #=> &ldquo;adb&rdquo;</p>

<h1>或者</h1>

<p>File.basename(&lsquo;/tmp/adb.log&rsquo;, &lsquo;.*&rsquo;)   #=> &ldquo;adb&rdquo;
```</p>

<h3>列出目录下的全部子文件</h3>

<p>```ruby</p>

<h1>替换puts child为自己的操作</h1>

<p>Dir[&lsquo;/tmp/*&rsquo;].each{|child|puts child}
```</p>

<h3>获得父目录</h3>

<p>```ruby</p>

<h1>特定目录的父路径</h1>

<p>File.expand_path(&ldquo;..&rdquo;,specific_path)</p>

<h1>当前目录的父路径</h1>

<p>File.expand_path(&ldquo;..&rdquo;,Dir.pwd)</p>

<h1>或者</h1>

<p>File.expand_path(&ldquo;..&rdquo;)
```</p>

<h3>其他</h3>

<ul>
<li><a href="http://www.amazon.cn/gp/product/B0061XKRXA/ref=as_li_tf_tl?ie=UTF8&camp=536&creative=3200&creativeASIN=B0061XKRXA&linkCode=as2&tag=droidyue-23">代码大全</a><img src="http://ir-cn.amazon-adsystem.com/e/ir?t=droidyue-23&l=as2&o=28&a=B0061XKRXA" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" /></li>
<li><a href="http://www.amazon.cn/gp/product/B005KGBTQ8/ref=as_li_tf_tl?ie=UTF8&camp=536&creative=3200&creativeASIN=B005KGBTQ8&linkCode=as2&tag=droidyue-23">松本行弘的程序世界</a><img src="http://ir-cn.amazon-adsystem.com/e/ir?t=droidyue-23&l=as2&o=28&a=B005KGBTQ8" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" /></li>
<li><a href="http://www.amazon.cn/gp/product/B004WHZGZQ/ref=as_li_tf_tl?ie=UTF8&camp=536&creative=3200&creativeASIN=B004WHZGZQ&linkCode=as2&tag=droidyue-23">黑客与画家:硅谷创业之父Paul Graham文集</a><img src="http://ir-cn.amazon-adsystem.com/e/ir?t=droidyue-23&l=as2&o=28&a=B004WHZGZQ" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" /></li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Ruby检测Gem是否安装]]></title>
    <link href="http://droidyue.com/blog/2014/08/19/check-for-ruby-gem-availability/"/>
    <updated>2014-08-19T20:04:00+08:00</updated>
    <id>http://droidyue.com/blog/2014/08/19/check-for-ruby-gem-availability</id>
    <content type="html"><![CDATA[<p>最近参加七牛的<a href="https://portal.qiniu.com/contest/demo2014" target="_blank">demo大赛</a>,决定使用ruby开发。于是遇到了一些疑问，然后解决了，这里记录一下。</p>

<p>在Ruby中，Gem是一个很常见的东西，其相当于插件，Ruby有很多很棒的gem，避免了我们重复造轮子，我的demo中需要安装gem，但是为了更加实现好一些，先检测gem是否已经安装，如果没有安装，在继续安装，否则不安装。</p>

<!--more-->


<p>于是，怎么在Ruby中检测gem是否安装呢，其实也很简单，直接上代码就可以了。不需太多解释。begin&hellip;rescue&hellip;相当于java中的try catch。
```ruby lineos:false</p>

<h1>!/usr/bin/env ruby</h1>

<h1>encoding: utf-8</h1>

<p>def checkGemAvailable(gemName, versionLimit=nil)</p>

<pre><code>isAvailable = false
begin
    if versionLimit == nil
        gem  gemName
    else
        gem  gemName, versionLimit
    end
    isAvailable = true
rescue LoadError
end
isAvailable
</code></pre>

<p>end
<code>
跑起来看一看
</code>ruby lineos:false
puts checkGemAvailable(&lsquo;rack&rsquo;)
puts checkGemAvailable(&lsquo;rack&rsquo;, &lsquo;>=2&rsquo;)
<code>
我机器的rack信息
</code>bash lineos:false
rack (1.5.2)
<code>
所以上面执行的结果为
</code>bash lineos:false
true
false
```</p>

<h3>其他</h3>

<ul>
<li><a href="http://www.amazon.cn/gp/product/B0061XKRXA/ref=as_li_tf_tl?ie=UTF8&camp=536&creative=3200&creativeASIN=B0061XKRXA&linkCode=as2&tag=droidyue-23">代码大全</a><img src="http://ir-cn.amazon-adsystem.com/e/ir?t=droidyue-23&l=as2&o=28&a=B0061XKRXA" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" /></li>
<li><a href="http://www.amazon.cn/gp/product/B005KGBTQ8/ref=as_li_tf_tl?ie=UTF8&camp=536&creative=3200&creativeASIN=B005KGBTQ8&linkCode=as2&tag=droidyue-23">松本行弘的程序世界</a><img src="http://ir-cn.amazon-adsystem.com/e/ir?t=droidyue-23&l=as2&o=28&a=B005KGBTQ8" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" /></li>
<li><a href="http://www.amazon.cn/gp/product/B004WHZGZQ/ref=as_li_tf_tl?ie=UTF8&camp=536&creative=3200&creativeASIN=B004WHZGZQ&linkCode=as2&tag=droidyue-23">黑客与画家:硅谷创业之父Paul Graham文集</a><img src="http://ir-cn.amazon-adsystem.com/e/ir?t=droidyue-23&l=as2&o=28&a=B004WHZGZQ" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" /></li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Octopress中嵌入ruby代码如何不被解析]]></title>
    <link href="http://droidyue.com/blog/2014/08/18/how-to-escape-embeded-ruby-block-in-octopress/"/>
    <updated>2014-08-18T07:48:00+08:00</updated>
    <id>http://droidyue.com/blog/2014/08/18/how-to-escape-embeded-ruby-block-in-octopress</id>
    <content type="html"><![CDATA[<p>用Octopress写博客即将快一年了，感觉自己用的还可以，并且借此熟练使用了Markdown，但是前几天写一篇关于如何在Octopress中集成多说评论的文章的时候，遇到了一个代码高亮的问题，就是如何处理{{}}代码块的问题。</p>

<!--more-->


<h2>问题描述</h2>

<p>默认的{{}}作为嵌入的ruby代码会被解释然后转成其真实的值对应的HTML代码形式。</p>

<h2>举个例子</h2>

<p><code>{{ page.title }}</code>代表当前页面的标题，默认情况下，如果执行了<code>rake generate &amp;&amp; rake preview</code>，这段代码会被解释成了<strong>{{page.title}}</strong></p>

<p>但是我们想要的是原样输出，类似这样在代码块中。
<code>html
{% raw %}{{ page.title }}{% endraw %}
</code></p>

<h2>如何做到</h2>

<p>如果想避免嵌入的ruby代码块被解析，使用&#123;% raw %&#125;和&#123;% endraw %&#125;来包裹不想被解析的代码块即可。示例如下</p>

<p>&#123;% raw %&#125;{% raw %}{{ page.title }}{% endraw %}&#123;% endraw %&#125;
&#123;% raw %&#125;{% raw %}{{ page.url }}{% endraw %}&#123;% endraw %&#125;</p>

<h2>更棘手的</h2>

<p>如果出现了<code>Liquid Exception: Unknown tag 'endraw' in _posts</code>这样的问题，
使用<code>&amp;#123;</code>代替<strong>{</strong>,使用<code>&amp;#125;</code>代替<strong>}</strong></p>

<h3>其他</h3>

<ul>
<li><a href="http://www.amazon.cn/gp/product/B0061XKRXA/ref=as_li_tf_tl?ie=UTF8&camp=536&creative=3200&creativeASIN=B0061XKRXA&linkCode=as2&tag=droidyue-23">代码大全</a><img src="http://ir-cn.amazon-adsystem.com/e/ir?t=droidyue-23&l=as2&o=28&a=B0061XKRXA" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" /></li>
<li><a href="http://www.amazon.cn/gp/product/B005KGBTQ8/ref=as_li_tf_tl?ie=UTF8&camp=536&creative=3200&creativeASIN=B005KGBTQ8&linkCode=as2&tag=droidyue-23">松本行弘的程序世界</a><img src="http://ir-cn.amazon-adsystem.com/e/ir?t=droidyue-23&l=as2&o=28&a=B005KGBTQ8" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" /></li>
<li><a href="http://www.amazon.cn/gp/product/B004WHZGZQ/ref=as_li_tf_tl?ie=UTF8&camp=536&creative=3200&creativeASIN=B004WHZGZQ&linkCode=as2&tag=droidyue-23">黑客与画家:硅谷创业之父Paul Graham文集</a><img src="http://ir-cn.amazon-adsystem.com/e/ir?t=droidyue-23&l=as2&o=28&a=B004WHZGZQ" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" /></li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Ruby程序区分运行来源]]></title>
    <link href="http://droidyue.com/blog/2014/08/17/how-to-determin-file-load-type-in-ruby/"/>
    <updated>2014-08-17T20:12:00+08:00</updated>
    <id>http://droidyue.com/blog/2014/08/17/how-to-determin-file-load-type-in-ruby</id>
    <content type="html"><![CDATA[<p>当我们在写模块的时候，或多或少需要直接运行这个文件也可以执行一些方法，但是这样对于当这个模块被require或者include时，显得不好，在ruby里，有没有区分运行来自当前文件，还是被require的目标文件调用呢？</p>

<h2>Python可以</h2>

<p>比如像Python这样
```python lineos:false
if <strong>name</strong> == &lsquo;<strong>main</strong>&rsquo;:</p>

<pre><code>print "from direct running"
</code></pre>

<p>```</p>

<!--more-->


<h2>Ruby当然也可以</h2>

<p>对于处处为程序员着想，拥有快乐编程理念的Ruby来说当然是可以区别的。其原理就是判断启动文件是否为模块的代码文件。
```ruby lineos:false
if <strong>FILE</strong> == $0</p>

<pre><code>puts 'called from direct running'
</code></pre>

<p>end
```</p>

<h2>举个例子</h2>

<p>工具类模块utils.rb
```ruby lineos:false
module Utils</p>

<pre><code>class StringUtils
    def self.test
        puts "test method myfile=" + __FILE__ + ';load from ' +  $0
    end
end
</code></pre>

<p>end</p>

<p>if <strong>FILE</strong> == $0</p>

<pre><code>puts 'called from direct running'
Utils::StringUtils.test() 
</code></pre>

<p>end
<code>
直接运行，结果,if条件成立，执行了输出
</code>bash lineos:false
20:04:37-androidyue~/rubydir/test$ ruby utils.rb
called from direct running
test method myfile=utils.rb;load from utils.rb
<code>
引用Utils的类test.rb
</code>ruby lineos:false
require &lsquo;./utils&rsquo;
Utils::StringUtils.test()
<code>
运行结果，引入模块的条件不成立，没有输出`called from direct running`
</code>bash lineos:false
20:08:07-androidyue~/rubydir/test$ ruby test.rb
test method myfile=/home/androidyue/rubydir/test/utils.rb;load from test.rb
```</p>

<h3>其他</h3>

<ul>
<li><a href="http://www.amazon.cn/gp/product/B0073APSCK/ref=as_li_tf_tl?ie=UTF8&camp=536&creative=3200&creativeASIN=B0073APSCK&linkCode=as2&tag=droidyue-23">Ruby元编程</a><img src="http://ir-cn.amazon-adsystem.com/e/ir?t=droidyue-23&l=as2&o=28&a=B0073APSCK" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" /></li>
<li><a href="http://www.amazon.cn/gp/product/B00D1HUYVE/ref=as_li_tf_tl?ie=UTF8&camp=536&creative=3200&creativeASIN=B00D1HUYVE&linkCode=as2&tag=droidyue-23">代码的未来</a><img src="http://ir-cn.amazon-adsystem.com/e/ir?t=droidyue-23&l=as2&o=28&a=B00D1HUYVE" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" /></li>
<li><a href="http://www.amazon.cn/gp/product/B005KGBTQ8/ref=as_li_tf_tl?ie=UTF8&camp=536&creative=3200&creativeASIN=B005KGBTQ8&linkCode=as2&tag=droidyue-23">大神松本行弘的程序世界</a><img src="http://ir-cn.amazon-adsystem.com/e/ir?t=droidyue-23&l=as2&o=28&a=B005KGBTQ8" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" /></li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Issues About Installing Octopress]]></title>
    <link href="http://droidyue.com/blog/2013/09/07/issues-about-installing-octopress/"/>
    <updated>2013-09-07T15:44:00+08:00</updated>
    <id>http://droidyue.com/blog/2013/09/07/issues-about-installing-octopress</id>
    <content type="html"><![CDATA[<p>Actually I am fresh to Write Blog with Octopress in Github Pages.According to the <a href="http://octopress.org/docs/deploying/github/" alt="Introduction for Installing Octopress in Github Pages" target="_blank">Introduction</a>   .And now I have make it avaible and the website is present.
However I have suffered some problems when I did the setup.Here is a summary of what I have sufferd and how I resolved.</p>

<h5>Could not find rdiscount-2.0.7.3 in any of the sources Run <code>bundle install</code> to install missing gems.</h5>

<pre><code>source ~/.rvm/scripts/rvm
rvm use 1.9.3 --default 
</code></pre>

<h5>I have used <code>rake preview </code>,But I got 404 when I open the <a href="http://127.0.0.1">http://127.0.0.1:4000</a></h5>

<pre><code>[androidyue@androidyue octopress]$ rake preview
Starting to watch source with Jekyll and Compass. Starting Rack on port 4000
[2013-09-07 15:46:20] INFO  WEBrick 1.3.1
[2013-09-07 15:46:20] INFO  ruby 1.9.3 (2013-06-27) [i686-linux]
[2013-09-07 15:46:20] INFO  WEBrick::HTTPServer#start: pid=10490 port=4000
Configuration from /home/androidyue/github/octopress/_config.yml
Auto-regenerating enabled: source -&gt; public/
[2013-09-07 15:46:21] regeneration: 95 files changed
&gt;&gt;&gt; Change detected at 15:46:21 to: screen.scss
   create public/github/stylesheets/screen.css 
   Errno::ENOENT on line ["56"] of /home/androidyue/.rvm/gems/ruby-1.9.3-p448/gems/compass-0.12.2/lib/compass/actions.rb: No such file or directory - /home/androidyue/github/octopress/public/github/stylesheets/screen.css
   Run with --trace to see the full backtrace]
</code></pre>

<p>As the above information and all the sources are outputed in public/ folder And the following are a part of my _config.yml file</p>

<pre><code># If publishing to a subdirectory as in http://site.com/project set 'root: /project'
root: /
permalink: /blog/:year/:month/:day/:title/
source: source
destination: public/
plugins: plugins
code_dir: downloads/code
category_dir: blog/categories
</code></pre>

<p>So compare the two piece information and check the output dir and is public or a subdirectory in public folder.If your outputdir is a subdirectory you should use this link <a href="http://127.0.0.1:4000/yourSubDirName">http://127.0.0.1:4000/yourSubDirName</a>
P.S.This is the help from StackOverflow <a href="http://stackoverflow.com/questions/17465404/rake-preview-not-working-in-octopress">http://stackoverflow.com/questions/17465404/rake-preview-not-working-in-octopress</a></p>

<p>I will keep record about this topic becuase I am making friends with Octopress in Github Pages</p>
]]></content>
  </entry>
  
</feed>
