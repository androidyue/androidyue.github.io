<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: 网站 | 技术小黑屋]]></title>
  <link href="http://droidyue.com/blog/categories/wang-zhan/atom.xml" rel="self"/>
  <link href="http://droidyue.com/"/>
  <updated>2015-07-18T13:39:45+08:00</updated>
  <id>http://droidyue.com/</id>
  <author>
    <name><![CDATA[androidyue]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Octopress中处理加网分享问题]]></title>
    <link href="http://droidyue.com/blog/2014/08/06/fix-conflicts-of-jiathis-in-octopress/"/>
    <updated>2014-08-06T19:44:00+08:00</updated>
    <id>http://droidyue.com/blog/2014/08/06/fix-conflicts-of-jiathis-in-octopress</id>
    <content type="html"><![CDATA[<p>作为一个以内容为中心的网站，在文章结尾增加社会化分享按钮是一种标配，使用Octopress也不例外，本博客选用了加网的社会化分享按钮。开始的时候一切顺利，但是后来出现了一点小瑕疵，具体的情况如下图</p>

<!--more-->


<p><img class="<a" src="href="http://droidyueimg.qiniudn.com/jiathis_flash_issue.png">http://droidyueimg.qiniudn.com/jiathis_flash_issue.png</a>" title="Octoress jiathis Issue" ></p>

<h2>究其原因</h2>

<p>我们来看看出问题的HTML代码。
```html linenos:false</p>

<div class="flash-video">
    <object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="0" height="0" id="JIATHISSWF" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab">
        <param name="allowScriptAccess" value="always">
        <param name="swLiveConnect" value="true">
        <param name="movie" value="http://www.jiathis.com/code/swf/m.swf">
        <param name="FlashVars" value="z=a">
        <embed name="JIATHISSWF" src="http://www.jiathis.com/code/swf/m.swf" flashvars="z=a" width="0" height="0" allowscriptaccess="always" swliveconnect="true" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer">
    </object>
</div>


<p>```</p>

<p>压缩css代码之后发现了这样一段代码。
```css linenos:false
article img,article video,article .flash-video {</p>

<pre><code>-webkit-border-radius:0.3em;
-moz-border-radius:0.3em;
-ms-border-radius:0.3em;
-o-border-radius:0.3em;
border-radius:0.3em;
-webkit-box-shadow:rgba(0,0,0,0.15) 0 1px 4px;
-moz-box-shadow:rgba(0,0,0,0.15) 0 1px 4px;
box-shadow:rgba(0,0,0,0.15) 0 1px 4px;
-webkit-box-sizing:border-box;
-moz-box-sizing:border-box;
box-sizing:border-box;
border:#fff 0.5em solid
</code></pre>

<p>}
<code>``
这句话</code>border:#fff 0.5em solid`就会产生我们所看到的白色的遮挡。</p>

<h2>解决问题</h2>

<p>思路：对id为JIATHISSWF的Object不应用包裹flash-video的div即可。
需要修改的文件为<strong>source/javascripts/octopress.js</strong></p>

<h3>这是原来的代码</h3>

<p>```javascript linenos:false source/javascripts/octopress.js
function wrapFlashVideos() {
  $(&lsquo;object&rsquo;).each(function(i, object) {</p>

<pre><code>if( $(object).find('param[name=movie]').length ){
  $(object).wrap('&lt;div class="flash-video"&gt;')
}
</code></pre>

<p>  });
  $(&lsquo;iframe[src<em>=vimeo],iframe[src</em>=youtube]&rsquo;).wrap(&lsquo;<div class="flash-video">&rsquo;)
}
```</p>

<h3>这是修改后的代码</h3>

<p>```javascript linenos:false source/javascripts/octopress.js
function wrapFlashVideos() {
  $(&lsquo;object&rsquo;).each(function(i, object) {</p>

<pre><code>if ($(object).attr('id') != "JIATHISSWF") {
  if( $(object).find('param[name=movie]').length ){
    $(object).wrap('&lt;div class="flash-video"&gt;')
  }
}
</code></pre>

<p>  });
  $(&lsquo;iframe[src<em>=vimeo],iframe[src</em>=youtube]&rsquo;).wrap(&lsquo;<div class="flash-video">&rsquo;)
}
```
OK，到这里就解决问题了，检查一下看看吧。</p>

<h3>其他</h3>

<ul>
<li><a href="http://www.amazon.cn/gp/product/B007VEF454/ref=as_li_tf_tl?ie=UTF8&camp=536&creative=3200&creativeASIN=B007VEF454&linkCode=as2&tag=droidyue-23">网站优化也是艺术</a><img src="http://ir-cn.amazon-adsystem.com/e/ir?t=droidyue-23&l=as2&o=28&a=B007VEF454" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" /></li>
<li><a href="http://www.amazon.cn/gp/product/B00G6SNZXY/ref=as_li_tf_tl?ie=UTF8&camp=536&creative=3200&creativeASIN=B00G6SNZXY&linkCode=as2&tag=droidyue-23">就这样设计大型网站</a><img src="http://ir-cn.amazon-adsystem.com/e/ir?t=droidyue-23&l=as2&o=28&a=B00G6SNZXY" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" /></li>
<li><a href="http://www.amazon.cn/gp/product/B00C5KS5AA/ref=as_li_tf_tl?ie=UTF8&camp=536&creative=3200&creativeASIN=B00C5KS5AA&linkCode=as2&tag=droidyue-23">极客:改变世界的创新基因</a><img src="http://ir-cn.amazon-adsystem.com/e/ir?t=droidyue-23&l=as2&o=28&a=B00C5KS5AA" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" /></li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Octopress添加回到顶部功能]]></title>
    <link href="http://droidyue.com/blog/2014/08/03/integrate-scroll-to-top-in-octopress/"/>
    <updated>2014-08-03T20:47:00+08:00</updated>
    <id>http://droidyue.com/blog/2014/08/03/integrate-scroll-to-top-in-octopress</id>
    <content type="html"><![CDATA[<p>在Octopress当阅读到文章底部的时候，或多或少都想回到顶部，而默认的Octopress没有提供回到顶部的功能，于是一不做二不休，自己找个控件加上。</p>

<!--more-->


<h2>现成的资源</h2>

<p><a href="http://www.scrolltotop.com/" target="_blank">Scroll To Top</a> 这个网站提供了数十种回到顶部的样式。你可以根据自己的需要，添加所中意的widget。</p>

<h2>如何添加</h2>

<h3>新建一个文件来存放widget代码</h3>

<p>文件归属目录<strong>source/_includes/custom/</strong>,假设文件名为<strong>scroll_to_top.html</strong>
```html linenos:false source/_includes/custom/scroll_to_top.html</p>

<script type="text/javascript" src="http://arrow.scrolltotop.com/arrow37.js"></script>


<p><noscript>Not seeing a <a href="http://www.scrolltotop.com/">Scroll to Top Button</a>? Go to our FAQ page for more info.</noscript>
```
注意，默认Octopress引入了jquery.min.js，所以没有必要再次引入。</p>

<h3>引入代码</h3>

<p>回到顶部功能，不仅仅要在文章页生效，同时也需要对类似归档页面有效才完美。于是我们需要找一个公用的位置。这个位置就是<strong>source/_layouts/default.html</strong>
<code>html linenos:false source/_layouts/default.html
  &lt;footer role="contentinfo"&gt;{% include footer.html %}&lt;/footer&gt;
  {% include after_footer.html %}
  {% include custom/scroll_to_top.html %}
&lt;/body&gt;
&lt;/html&gt;
</code></p>

<h2>更加完美</h2>

<p>Octopress默认的为所有的div添加了一个背景，所以上述完成之后看到的图片是有一个灰色背景的，需要去除一下。修改以下文件即可。<strong>sass/base/_theme.scss</strong>
```css linenos:false sass/base/_theme.scss
body {</p>

<blockquote><p>div:not(#ds-wrapper):not(#topcontrol){</p>

<pre><code>background: $sidebar-bg $noise-bg;
border-bottom: 1px solid $page-border-bottom;
&gt; div {
  background: $main-bg $noise-bg;
  border-right: 1px solid $sidebar-border;
}
</code></pre>

<p>  }
}
```
其中我们添加的div的id为topcontrol。当然前面的ds-wrapper是为了去除多说评论框登陆的背景问题，如不需要可以去掉。</p></blockquote>

<p>到这里，你已经完成了一个可以秒杀新浪微博的回到顶部的功能啦，恭喜哈。</p>

<h3>其他</h3>

<ul>
<li><a href="http://www.amazon.cn/gp/product/B00B01LKQ6/ref=as_li_tf_tl?ie=UTF8&camp=536&creative=3200&creativeASIN=B00B01LKQ6&linkCode=as2&tag=droidyue-23">如何以数据驱动决策,提升网站价值</a><img src="http://ir-cn.amazon-adsystem.com/e/ir?t=droidyue-23&l=as2&o=28&a=B00B01LKQ6" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" /></li>
<li><a href="http://www.amazon.cn/gp/product/B0011BTJV8/ref=as_li_tf_tl?ie=UTF8&camp=536&creative=3200&creativeASIN=B0011BTJV8&linkCode=as2&tag=droidyue-23">访客至上的网页设计秘笈</a><img src="http://ir-cn.amazon-adsystem.com/e/ir?t=droidyue-23&l=as2&o=28&a=B0011BTJV8" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" /></li>
<li><a href="http://www.amazon.cn/gp/product/B00C5KS5AA/ref=as_li_tf_tl?ie=UTF8&camp=536&creative=3200&creativeASIN=B00C5KS5AA&linkCode=as2&tag=droidyue-23">极客:改变世界的创新基因</a><img src="http://ir-cn.amazon-adsystem.com/e/ir?t=droidyue-23&l=as2&o=28&a=B00C5KS5AA" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" /></li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Ocotpress集成多说评论]]></title>
    <link href="http://droidyue.com/blog/2014/07/29/integrate-duoshuo-in-octopress/"/>
    <updated>2014-07-29T21:02:00+08:00</updated>
    <id>http://droidyue.com/blog/2014/07/29/integrate-duoshuo-in-octopress</id>
    <content type="html"><![CDATA[<p>Octopress默认自带了DISQUS，但是对于国内不是很好用。于是一开始替换了国内的友言。但是后来发现用友言的人不多，而且感觉友言加载速度比较慢。然后就是到了今天的多说了。官方并没有给出具体针对Octopress的解决指导。我这里记录一下如何集成，并且解决一些常见的问题。</p>

<!--more-->


<h2>集成</h2>

<h3>来说评论框</h3>

<p>这就是多说提供的通用代码中,其实理论上以下三个值通过javascript都可以得到的。
```html linenos:false</p>

<!-- 多说评论框 start -->


<pre><code>&lt;div class="ds-thread" data-thread-key="请将此处替换成文章在你的站点中的ID" data-title="请替换成文章的标题" data-url="请替换成文章的网址"&gt;&lt;/div&gt;
</code></pre>

<!-- 多说评论框 end -->


<p><code>
如果换成Octopress（准确的来说是jekyll ）的变量，应该是这样子。
</code>html linenos:false</p>

<!-- 多说评论框 start -->


<div class="ds-thread" data-thread-key="{{ page.id }}" data-title="{{ page.title }}" data-url="{{site.url}}{{ page.url  }}"></div>


<!-- 多说评论框 end -->


<p>```</p>

<h3>整合公共JS代码</h3>

<p>在Octopress的<strong>source/_includes/post</strong>目录下，新建一个文件，比如<strong>duoshuo.html</strong>
其代码如下,
```html source/_includes/post/duoshuo.html linenos:false</p>

<!-- 多说评论框 start -->


<div class="ds-thread" data-thread-key="{{ page.id }}" data-title="{{ page.title }}" data-url="{{site.url}}{{ page.url  }}"></div>


<!-- 多说评论框 end -->


<!-- 多说公共JS代码 start (一个网页只需插入一次) -->


<script type="text/javascript">
    var duoshuoQuery = {short_name:"your_short_name"};
    (function() {

        var ds = document.createElement('script');
        ds.type = 'text/javascript';ds.async = true;
        ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
        ds.charset = 'UTF-8';
        (document.getElementsByTagName('head')[0] 
         || document.getElementsByTagName('body')[0]).appendChild(ds);
     })();
 </script>


<p> <!-- 多说公共JS代码 end -->
<code>
注意，请修改上面代码中的short_name
</code>javascript linenos:false
 var duoshuoQuery = {short_name:&ldquo;your_short_name&rdquo;};
```
关于short_name的这个值，需要从多说后台查找，如下图
<img class="<a" src="href="http://droidyueimg.qiniudn.com/duoshuo_short_name.png">http://droidyueimg.qiniudn.com/duoshuo_short_name.png</a>"></p>

<h3>将文件嵌入到<strong><code>&lt;body&gt;&lt;/body&gt;</code></strong></h3>

<p>将上面的文件嵌入到<strong>source/_layouts/post.html</strong>下，可参考下列代码。
```html source/_layouts/post.html linenos:false
  </footer>
  </article>
{% if page.comments == true %}
  <section>
   {% include post/duoshuo.html %}
  </section>
 {% endif %}
</div>
{% unless page.sidebar == false %}
<aside class="sidebar">
  {% if site.post_asides.size %}</p>

<pre><code>{% include_array post_asides %}
</code></pre>

<p>  {% else %}</p>

<pre><code>{% include_array default_asides %}
</code></pre>

<p>  {% endif %}
</aside>
{% endunless %}
```</p>

<p>同样，将文件嵌入到<strong>source/_layouts/page.html</strong>里面
```html source/_layouts/page.html lineos:false
{% if  page.comments == true %}
<section>
 {% include post/duoshuo.html %}
  </section>
{% endif %}
</div>
{% unless page.sidebar == false %}
<aside class="sidebar">
  {% if site.page_asides.size %}</p>

<pre><code>{% include_array page_asides %}
</code></pre>

<p>  {% else %}</p>

<pre><code>{% include_array default_asides %}
</code></pre>

<p>  {% endif %}
</aside>
{% endunless %}
```
到这里，基本可以跑成功了。</p>

<h2>问题解决</h2>

<h3>表象</h3>

<p>不要高兴的太早，集成后的多说还是有点小问题，就是当需要登陆或者输入邮箱地址的时候，会出现如下图的问题，登陆框的背后有一层带颜色的层。
<img class="<a" src="href="http://droidyueimg.qiniudn.com/duoshuo_background_issue.png">http://droidyueimg.qiniudn.com/duoshuo_background_issue.png</a>" title="duoshuo issue in Octopress" ></p>

<h3>原因</h3>

<p>具体原因是我所使用的css为所有的body div增加了一个背景。下图为id为ds-wrapper的div的背景属性
<img class="<a" src="href="http://droidyueimg.qiniudn.com/div_background_property.png">http://droidyueimg.qiniudn.com/div_background_property.png</a>" title="ds-wrapper div background" ></p>

<h3>解决</h3>

<p>昨天晚上自己找到了一个可行的办法，思路就是对所有body div的设置不应用到id为ds-wrapper的div
默认的设置如下。文件为sass/base/<em>theme.scss
```css sass/base/</em>theme.scss linenos:false
body {</p>

<blockquote><p>div {</p>

<pre><code>background: $sidebar-bg $noise-bg;
border-bottom: 1px solid $page-border-bottom;
&gt; div {
  background: $main-bg $noise-bg;
  border-right: 1px solid $sidebar-border;
}
</code></pre>

<p>  }
}
<code>
使用not把ds-wrapper加入例外，修改为这样的设置
</code>css sass/base/_theme.scss linenos:false
body {
div:not(#ds-wrapper){</p>

<pre><code>background: $sidebar-bg $noise-bg;
border-bottom: 1px solid $page-border-bottom;
&gt; div {
  background: $main-bg $noise-bg;
  border-right: 1px solid $sidebar-border;
}
</code></pre>

<p>  }
}</p></blockquote>

<p>```</p>

<p>到这里，就比较完美的解决了问题，边Google变StackOverflow解决了问题了，哈哈。</p>

<h2>延伸</h2>

<p><a href="https://developer.mozilla.org/en-US/docs/Web/CSS/%3anot?redirectlocale=en-US&redirectslug=CSS%2F%3Anot" target="_blank">CSS not API</a></p>

<h3>其他</h3>

<ul>
<li><a href="http://www.amazon.cn/gp/product/B00B01LKQ6/ref=as_li_tf_tl?ie=UTF8&camp=536&creative=3200&creativeASIN=B00B01LKQ6&linkCode=as2&tag=droidyue-23">如何以数据驱动决策,提升网站价值</a><img src="http://ir-cn.amazon-adsystem.com/e/ir?t=droidyue-23&l=as2&o=28&a=B00B01LKQ6" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" /></li>
<li><a href="http://www.amazon.cn/gp/product/B0011BTJV8/ref=as_li_tf_tl?ie=UTF8&camp=536&creative=3200&creativeASIN=B0011BTJV8&linkCode=as2&tag=droidyue-23">访客至上的网页设计秘笈</a><img src="http://ir-cn.amazon-adsystem.com/e/ir?t=droidyue-23&l=as2&o=28&a=B0011BTJV8" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" /></li>
</ul>

]]></content>
  </entry>
  
</feed>
